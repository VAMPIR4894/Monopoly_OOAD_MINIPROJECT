<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Game Board</title>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script type="text/javascript" src="/js/game-board.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/game-board.css" />
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <div id="popupbackground"></div>
    <div id="popupwrap">
        <div id="popup">
            <div style="position: relative;">
                <div id="popuptext"></div>
                <div id="popupdrag"></div>
            </div>
        </div>
    </div>

    <div id="statsbackground"></div>
    <div id="statswrap">
        <div id="stats">
            <div style="position: relative;">
                <img id="statsclose" src="/images/close.png" title="Close" alt="x" />
                <div id="statstext"></div>
                <div id="statsdrag"></div>
            </div>
        </div>
    </div>

    <div id="setup" style="display: none;">
        <div style="margin-bottom: 20px;">
            <h2>Select number of players</h2>
            <select id="playernumber" title="Select the number of players for the game.">
                <option>2</option>
                <option>3</option>
                <option selected="selected">4</option>
            </select>
        </div>

        <div id="player1input" class="player-input">
            <h3>Player 1: </h3>
            <input type="text" id="player1name" title="Player name" maxlength="16" value="Player 1" />
            <select id="player1color" title="Player color">
                <option selected="selected" style="color: #FFFF00;">Yellow</option>
                <option style="color: #0000FF;">Blue</option>
                <option style="color: #FF0000;">Red</option>
                <option style="color: #00FF00;">Lime</option>
            </select>
        </div>

        <div id="player2input" class="player-input">
            <h3>Player 2: </h3>
            <input type="text" id="player2name" title="Player name" maxlength="16" value="Player 2" />
            <select id="player2color" title="Player color">
                <option style="color: #FFFF00;">Yellow</option>
                <option selected="selected" style="color: #0000FF;">Blue</option>
                <option style="color: #FF0000;">Red</option>
                <option style="color: #00FF00;">Lime</option>
            </select>
        </div>

        <div id="player3input" class="player-input">
            <h3>Player 3: </h3>
            <input type="text" id="player3name" title="Player name" maxlength="16" value="Player 3" />
            <select id="player3color" title="Player color">
                <option style="color: #FFFF00;">Yellow</option>
                <option style="color: #0000FF;">Blue</option>
                <option selected="selected" style="color: #FF0000;">Red</option>
                <option style="color: #00FF00;">Lime</option>
            </select>
        </div>

        <div id="player4input" class="player-input">
            <h3>Player 4: </h3>
            <input type="text" id="player4name" title="Player name" maxlength="16" value="Player 4" />
            <select id="player4color" title="Player color">
                <option style="color: #FFFF00;">Yellow</option>
                <option style="color: #0000FF;">Blue</option>
                <option style="color: #FF0000;">Red</option>
                <option selected="selected" style="color: #00FF00;">Lime</option>
            </select>
        </div>

        <div style="margin: 20px 0px;">
            <input type="button" value="Start Game" onclick="setup();" title="Begin playing." />
        </div>
    </div>

    <table id="board">
        <tr>
            <td class="cell board-corner" id="cell20"></td>
            <td class="cell board-top" id="cell21"></td>
            <td class="cell board-top" id="cell22"></td>
            <td class="cell board-top" id="cell23"></td>
            <td class="cell board-top" id="cell24"></td>
            <td class="cell board-top" id="cell25"></td>
            <td class="cell board-top" id="cell26"></td>
            <td class="cell board-top" id="cell27"></td>
            <td class="cell board-top" id="cell28"></td>
            <td class="cell board-top" id="cell29"></td>
            <td class="cell board-corner" id="cell30"></td>
        </tr>
        <tr>
            <td class="cell board-left" id="cell19"></td>
            <td colspan="9" class="board-center"></td>
            <td class="cell board-right" id="cell31"></td>
        </tr>
        <tr>
            <td class="cell board-left" id="cell18"></td>
            <td colspan="9" class="board-center"></td>
            <td class="cell board-right" id="cell32"></td>
        </tr>
        <tr>
            <td class="cell board-left" id="cell17"></td>
            <td colspan="9" class="board-center"></td>
            <td class="cell board-right" id="cell33"></td>
        </tr>
        <tr>
            <td class="cell board-left" id="cell16"></td>
            <td colspan="9" class="board-center"></td>
            <td class="cell board-right" id="cell34"></td>
        </tr>
        <tr>
            <td class="cell board-left" id="cell15"></td>
            <td colspan="9" class="board-center"></td>
            <td class="cell board-right" id="cell35"></td>
        </tr>
        <tr>
            <td class="cell board-left" id="cell14"></td>
            <td colspan="9" class="board-center"></td>
            <td class="cell board-right" id="cell36"></td>
        </tr>
        <tr>
            <td class="cell board-left" id="cell13"></td>
            <td colspan="9" class="board-center"></td>
            <td class="cell board-right" id="cell37"></td>
        </tr>
        <tr>
            <td class="cell board-left" id="cell12"></td>
            <td colspan="9" class="board-center"></td>
            <td class="cell board-right" id="cell38"></td>
        </tr>
        <tr>
            <td class="cell board-left" id="cell11"></td>
            <td colspan="9" class="board-center">
                <div id="jail"></div>
            </td>
            <td class="cell board-right" id="cell39"></td>
        </tr>
        <tr>
            <td class="cell board-corner" id="cell10"></td>
            <td class="cell board-bottom" id="cell9"></td>
            <td class="cell board-bottom" id="cell8"></td>
            <td class="cell board-bottom" id="cell7"></td>
            <td class="cell board-bottom" id="cell6"></td>
            <td class="cell board-bottom" id="cell5"></td>
            <td class="cell board-bottom" id="cell4"></td>
            <td class="cell board-bottom" id="cell3"></td>
            <td class="cell board-bottom" id="cell2"></td>
            <td class="cell board-bottom" id="cell1"></td>
            <td class="cell board-corner" id="cell0"></td>
        </tr>
    </table>

    <div id="moneybarwrap">
        <div id="moneybar">
            <table>
                <tr id="moneybarrow1" class="money-bar-row">
                    <td class="moneybararrowcell"><img src="/images/arrow.png" id="p1arrow" class="money-bar-arrow" alt=">"/></td>
                    <td id="p1moneybar" class="moneybarcell">
                        <div><span id="p1moneyname">Player 1</span>:</div>
                        <div>$<span id="p1money">1500</span></div>
                    </td>
                </tr>
                <tr id="moneybarrow2" class="money-bar-row">
                    <td class="moneybararrowcell"><img src="/images/arrow.png" id="p2arrow" class="money-bar-arrow" alt=">" /></td>
                    <td id="p2moneybar" class="moneybarcell">
                        <div><span id="p2moneyname">Player 2</span>:</div>
                        <div>$<span id="p2money">1500</span></div>
                    </td>
                </tr>
                <tr id="moneybarrow3" class="money-bar-row">
                    <td class="moneybararrowcell"><img src="/images/arrow.png" id="p3arrow" class="money-bar-arrow" alt=">" /></td>
                    <td id="p3moneybar" class="moneybarcell">
                        <div><span id="p3moneyname">Player 3</span>:</div>
                        <div>$<span id="p3money">1500</span></div>
                    </td>
                </tr>
                <tr id="moneybarrow4" class="money-bar-row">
                    <td class="moneybararrowcell"><img src="/images/arrow.png" id="p4arrow" class="money-bar-arrow" alt=">" /></td>
                    <td id="p4moneybar" class="moneybarcell">
                        <div><span id="p4moneyname">Player 4</span>:</div>
                        <div>$<span id="p4money">1500</span></div>
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <div id="control">
        <table>
            <tr>
                <td style="text-align: left; vertical-align: top; border: none;">
                    <div id="menu">
                        <table id="menutable" cellspacing="0">
                            <tr>
                                <td class="menu-item" id="buy-menu-item">
                                    <a href="javascript:void(0);" title="View alerts and buy the property you landed on.">Buy</a>
                                </td>
                                <td class="menu-item" id="manage-menu-item">
                                    <a href="javascript:void(0);" title="View, mortgage, and improve your property.">Manage</a>
                                </td>
                                <td class="menu-item" id="trade-menu-item">
                                    <a href="javascript:void(0);" title="Exchange property with other players.">Trade</a>
                                </td>
                            </tr>
                        </table>
                    </div>
                </td>
                <td style="vertical-align: top; border: none;">
                    <div id="quickstats">
                        <div><span id="pname">Player 1</span>:</div>
                        <div><span id="pmoney">$1500</span></div>
                    </div>
                    <div>
                        <div id="die0" title="Die" class="die die-no-img"></div>
                        <div id="die1" title="Die" class="die die-no-img"></div>
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="2" style="border: none">
                    <div style="padding-top: 8px;">
                        <input type="button" id="nextbutton" title="Roll the dice and move your token accordingly." value="Roll Dice"/>
                        <input type="button" id="resignbutton" title="If you cannot pay your debt then you must resign from the game." value="Resign" />
                    </div>
                </td>
            </tr>
        </table>
    </div>

    <script>
        const sounds = {
            dice: new Audio("/assets/sounds/dice-roll.mp3"),
            buy: new Audio("/assets/sounds/buy-property.mp3"),
            cash: new Audio("/assets/sounds/cash-register.mp3"),
            click: new Audio("/assets/sounds/click.mp3")
        };

        const cooldowns = {};

        function playSound(name) {
            const now = Date.now();
            const lastPlayed = cooldowns[name] || 0;
            if (now - lastPlayed >= 6000) {
                if (sounds[name]) {
                    sounds[name].currentTime = 0;
                    sounds[name].play();
                    cooldowns[name] = now;
                }
            }
        }

        document.getElementById("nextbutton").addEventListener("click", () => playSound("dice"));
        document.getElementById("resignbutton").addEventListener("click", () => playSound("click"));

        let currentPlayer = 1;
        const totalPlayers = 4;
        const playerPositions = Array(totalPlayers).fill(0);

        document.addEventListener("DOMContentLoaded", function() {
            initializePlayerPositions();
            document.getElementById("nextbutton").addEventListener("click", rollDice);
        });

        function initializePlayerPositions() {
            for (let i = 1; i <= totalPlayers; i++) {
                const playerElement = document.createElement("div");
                playerElement.id = `player${i}`;
                playerElement.className = "player-token";
                document.getElementById("cell0").appendChild(playerElement);
                positionPlayerToken(i, 0);
            }
        }

        function positionPlayerToken(playerNumber, cellId) {
            const cell = document.getElementById(`cell${cellId}`);
            const playerElement = document.getElementById(`player${playerNumber}`);
            
            if (playerElement.parentElement) {
                playerElement.parentElement.removeChild(playerElement);
            }
            
            cell.appendChild(playerElement);
            
            const positions = [
                { top: '5px', left: '5px' },
                { top: '5px', right: '5px' },
                { bottom: '5px', left: '5px' },
                { bottom: '5px', right: '5px' }
            ];
            
            Object.assign(playerElement.style, positions[playerNumber - 1]);
        }

        function rollDice() {
            const die1 = Math.floor(Math.random() * 6) + 1;
            const die2 = Math.floor(Math.random() * 6) + 1;
            const total = die1 + die2;

            document.getElementById("die0").className = `die die-${die1}`;
            document.getElementById("die1").className = `die die-${die2}`;

            movePlayer(total);
            
            currentPlayer = (currentPlayer % totalPlayers) + 1;
            document.getElementById("pname").textContent = `Player ${currentPlayer}`;
        }

        function movePlayer(spaces) {
            const currentPosition = playerPositions[currentPlayer - 1];
            const newPosition = (currentPosition + spaces) % 40;
            playerPositions[currentPlayer - 1] = newPosition;
            
            positionPlayerToken(currentPlayer, newPosition);
        }

        function setup() {
            document.getElementById("setup").style.display = "none";
            // Additional setup logic can be added here
        }
    </script>
</body>
</html> 